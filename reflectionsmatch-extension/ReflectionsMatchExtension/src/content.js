(function(){"use strict";console.log("ReflectionsMatch Content Script Loaded");const c=(t,n="#4f46e5")=>{let e=document.getElementById("reflections-sync-banner");e||(e=document.createElement("div"),e.id="reflections-sync-banner",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.padding="10px",e.style.color="white",e.style.textAlign="center",e.style.zIndex="999999",e.style.boxShadow="0 2px 10px rgba(0,0,0,0.2)",e.style.fontFamily="system-ui, -apple-system, sans-serif",e.style.fontWeight="600",document.body.prepend(e)),e.style.backgroundColor=n,e.innerText=t},i=()=>{const t=document.getElementById("reflections-sync-banner");t&&t.remove()},r=()=>{const t=document.body.innerText,n=(y,m=1500)=>{const f=new RegExp(`${y}\\s*\\n`,"i"),o=t.match(f);return o&&o.index?t.substring(o.index+o[0].length,o.index+o[0].length+m):""},e=n("About",2e3),l=n("Experience",4e3),a=()=>document.querySelector("h1")?.innerText||"",d=()=>document.querySelector(".text-body-medium")?.innerText||"",u=()=>document.querySelector('meta[property="og:description"]')?.getAttribute("content")||"";return{name:a(),headline:d(),about:u(),deepProfileText:`About Section:
${e}

Experience Section:
${l}

(Extracted from LinkedIn)`,profileUrl:window.location.href,scrapedAt:new Date().toISOString()}},s=async()=>{c("Reflections Match: Syncing Profile... Please wait.","#4f46e5");const t=setInterval(()=>{window.scrollBy(0,500),window.innerHeight+window.scrollY>=document.body.scrollHeight-100&&(clearInterval(t),setTimeout(()=>{const n=r();console.log("Scraped Data:",n),chrome.runtime.sendMessage({type:"LINKEDIN_SYNC_DATA",data:n},e=>{e&&e.success?(c("Sync Complete! You can close this tab.","#10b981"),setTimeout(()=>i(),5e3)):c("Sync Failed. Please try again or use the extension popup.","#ef4444")}),window.scrollTo(0,0)},2e3))},200)};window.location.href.includes("reflections_sync=true")&&(document.readyState==="complete"?s():window.addEventListener("load",s))})();
